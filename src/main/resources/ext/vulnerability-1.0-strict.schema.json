{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "id": "http://cyclonedx.org/schema/ext/vulnerability-1.0-strict.schema.json",
  "type": "object",
  "definitions": {
    "vulnerability": {
      "type": "object",
      "title": "Vulnerability",
      "required": [
        "id",
        "ref"
      ],
      "additionalProperties": false,
      "properties": {
        "id": {
          "title": "id",
          "allOf": [
            {
              "$ref": "http://cyclonedx.org/schema/ext/vulnerability-1.0-types.schema.json#/definitions/normalizedString"
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "id",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        },
        "source": {
          "title": "source",
          "allOf": [
            {
              "$ref": "#/definitions/Vulnerability.Source"
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "source",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        },
        "ratings": {
          "title": "ratings",
          "allOf": [
            {
              "$ref": "#/definitions/Vulnerability.Ratings"
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "ratings",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        },
        "cwes": {
          "title": "cwes",
          "allOf": [
            {
              "$ref": "#/definitions/Vulnerability.Cwes"
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "cwes",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        },
        "description": {
          "title": "description",
          "allOf": [
            {
              "$ref": "http://cyclonedx.org/schema/ext/vulnerability-1.0-types.schema.json#/definitions/string"
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "description",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        },
        "recommendations": {
          "title": "recommendations",
          "allOf": [
            {
              "$ref": "#/definitions/Vulnerability.Recommendations"
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "recommendations",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        },
        "advisories": {
          "title": "advisories",
          "allOf": [
            {
              "$ref": "#/definitions/Vulnerability.Advisories"
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "advisories",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        },
        "ref": {
          "title": "ref",
          "allOf": [
            {
              "$ref": "http://cyclonedx.org/schema/ext/vulnerability-1.0-types.schema.json#/definitions/string"
            }
          ],
          "propertyType": "attribute",
          "attributeName": {
            "localPart": "ref",
            "namespaceURI": ""
          }
        }
      },
      "typeType": "classInfo",
      "typeName": {
        "localPart": "vulnerability",
        "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
      },
      "propertiesOrder": [
        "id",
        "source",
        "ratings",
        "cwes",
        "description",
        "recommendations",
        "advisories",
        "ref"
      ]
    },
    "Vulnerability.Source": {
      "type": "object",
      "title": "Vulnerability.Source",
      "required": [
        "name"
      ],
      "additionalProperties": false,
      "properties": {
        "url": {
          "title": "url",
          "allOf": [
            {
              "$ref": "http://cyclonedx.org/schema/ext/vulnerability-1.0-types.schema.json#/definitions/anyURI"
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "url",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        },
        "name": {
          "title": "name",
          "allOf": [
            {
              "$ref": "http://cyclonedx.org/schema/ext/vulnerability-1.0-types.schema.json#/definitions/normalizedString"
            }
          ],
          "propertyType": "attribute",
          "attributeName": {
            "localPart": "name",
            "namespaceURI": ""
          }
        }
      },
      "typeType": "classInfo",
      "propertiesOrder": [
        "url",
        "name"
      ]
    },
    "Vulnerability.Advisories": {
      "type": "array",
      "title": "Vulnerability.Advisories",
      "additionalProperties": false,
      "properties": {
        "advisory": {
          "title": "advisory",
          "allOf": [
            {
              "type": "array",
              "items": {
                "$ref": "http://cyclonedx.org/schema/ext/vulnerability-1.0-types.schema.json#/definitions/string"
              },
              "minItems": 0
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "advisory",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        }
      },
      "typeType": "classInfo",
      "propertiesOrder": [
        "advisory"
      ]
    },
    "Vulnerability.Ratings": {
      "type": "array",
      "title": "Vulnerability.Ratings",
      "additionalProperties": false,
      "properties": {
        "rating": {
          "title": "rating",
          "allOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ScoreType"
              },
              "minItems": 0
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "rating",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        }
      },
      "typeType": "classInfo",
      "propertiesOrder": [
        "rating"
      ]
    },
    "ScoreType.Score": {
      "type": "object",
      "title": "ScoreType.Score",
      "additionalProperties": false,
      "properties": {
        "base": {
          "title": "base",
          "allOf": [
            {
              "$ref": "http://cyclonedx.org/schema/ext/vulnerability-1.0-types.schema.json#/definitions/decimal"
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "base",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        },
        "impact": {
          "title": "impact",
          "allOf": [
            {
              "$ref": "http://cyclonedx.org/schema/ext/vulnerability-1.0-types.schema.json#/definitions/decimal"
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "impact",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        },
        "exploitability": {
          "title": "exploitability",
          "allOf": [
            {
              "$ref": "http://cyclonedx.org/schema/ext/vulnerability-1.0-types.schema.json#/definitions/decimal"
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "exploitability",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        }
      },
      "typeType": "classInfo",
      "propertiesOrder": [
        "base",
        "impact",
        "exploitability"
      ]
    },
    "Vulnerability.Cwes": {
      "type": "array",
      "title": "Vulnerability.Cwes",
      "additionalProperties": false,
      "properties": {
        "cwe": {
          "title": "cwe",
          "allOf": [
            {
              "type": "array",
              "items": {
                "$ref": "http://cyclonedx.org/schema/ext/vulnerability-1.0-types.schema.json#/definitions/integer"
              },
              "minItems": 0
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "cwe",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        }
      },
      "typeType": "classInfo",
      "propertiesOrder": [
        "cwe"
      ]
    },
    "ScoreType": {
      "type": "object",
      "title": "ScoreType",
      "additionalProperties": false,
      "properties": {
        "score": {
          "title": "score",
          "allOf": [
            {
              "$ref": "#/definitions/ScoreType.Score"
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "score",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        },
        "severity": {
          "title": "severity",
          "allOf": [
            {
              "$ref": "#/definitions/SeverityType"
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "severity",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        },
        "method": {
          "title": "method",
          "allOf": [
            {
              "$ref": "#/definitions/ScoreSourceType"
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "method",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        },
        "vector": {
          "title": "vector",
          "allOf": [
            {
              "$ref": "http://cyclonedx.org/schema/ext/vulnerability-1.0-types.schema.json#/definitions/string"
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "vector",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        }
      },
      "typeType": "classInfo",
      "typeName": {
        "localPart": "scoreType",
        "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
      },
      "propertiesOrder": [
        "score",
        "severity",
        "method",
        "vector"
      ]
    },
    "Vulnerability.Recommendations": {
      "type": "array",
      "title": "Vulnerability.Recommendations",
      "additionalProperties": false,
      "properties": {
        "recommendation": {
          "title": "recommendation",
          "allOf": [
            {
              "type": "array",
              "items": {
                "$ref": "http://cyclonedx.org/schema/ext/vulnerability-1.0-types.schema.json#/definitions/string"
              },
              "minItems": 0
            }
          ],
          "propertyType": "element",
          "elementName": {
            "localPart": "recommendation",
            "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
          }
        }
      },
      "typeType": "classInfo",
      "propertiesOrder": [
        "recommendation"
      ]
    },
    "ScoreSourceType": {
      "allOf": [
        {
          "$ref": "http://cyclonedx.org/schema/ext/vulnerability-1.0-types.schema.json#/definitions/string"
        },
        {
          "enum": [
            "CVSSv2",
            "CVSSv3",
            "OWASP Risk",
            "Open FAIR",
            "Other"
          ]
        }
      ],
      "typeType": "enumInfo",
      "typeName": {
        "localPart": "scoreSourceType",
        "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
      }
    },
    "SeverityType": {
      "allOf": [
        {
          "$ref": "http://cyclonedx.org/schema/ext/vulnerability-1.0-types.schema.json#/definitions/string"
        },
        {
          "enum": [
            "None",
            "Low",
            "Medium",
            "High",
            "Critical",
            "Unknown"
          ]
        }
      ],
      "typeType": "enumInfo",
      "typeName": {
        "localPart": "severityType",
        "namespaceURI": "http://cyclonedx.org/schema/ext/vulnerability/1.0"
      }
    }
  }
}
